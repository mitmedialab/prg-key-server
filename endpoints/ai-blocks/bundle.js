import{AES as t,enc as r,lib as e}from"crypto-js";const s={stringify:function(t){const e={ct:t.ciphertext.toString(r.Base64)};return t.iv&&(e.iv=t.iv.toString()),t.salt&&(e.s=t.salt.toString()),JSON.stringify(e)},parse:function(t){const s=JSON.parse(t),n=e.CipherParams.create({ciphertext:r.Base64.parse(s.ct)});return s.iv&&(n.iv=r.Hex.parse(s.iv)),s.s&&(n.salt=r.Hex.parse(s.s)),n}};async function n(e){const n="https://prg-key-server.netlify.app/.netlify/functions/ai-blocks-drive"+(i=e,"?"+Object.entries(i).map((([t,r])=>`${t}=${r}`)).join("&"));var i;const a=await fetch(n);if(!a.ok){return{error:await a.text()}}const c=await a.json(),{decrypt:o}=(e=>{e??=process.env.AES_PASSPHRASE;const n={format:s};return{encrypt:r=>t.encrypt(r,e,n),decrypt:s=>t.decrypt(s,e,n).toString(r.Utf8)}})(e.session);return c.map((([t,r])=>[o(t),o(r)])).reduce(((t,[r,e])=>(t[r]=e,t)),{})}export{n as default};
